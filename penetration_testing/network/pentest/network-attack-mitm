# ------------------------------- start mitm overview ------------------------------- # 
    ==> Quick View: there are many scenario for the arp poisoing attack:
        - host poisoing.
            attack create attack between two hosts, tha attacker will send gratuitous arp reply
            packets and send them to the both.
        - gateway poisoing.
            send arp reply to some or all hosts in a network, announcing his MAC
            as the MAC of the default gateway for the network.
        - dhcp spoofing.
            1st: new host is connected to the network, it sends a DHCP dicovery
            braodcast packet using UDP port 67. the source ip will be 0.0.0.0
            destination ip 255.255.255.255 255.255.255.255
            2nd: the DHCP server in the same broadcast domain responds with DHCP offer packet
            containing:
                - YIADDR        <10.1.1.3>
                    ==> explanation: contain IP that offering to the client
                - Lease Time    <time>
                - SRC IP        <DHCP_IP>
                - DST IP        <255.255.255.255>
                - MAC SRC       <DHCP_MAC>
                - MAC DST       <FF:FF:FF:FF:FF:FF>
            3rd: client respomds with another broadcast packet: DHCP request. the destination
            is still broadcast since more than one DHCP server may have send a DHCPOFFER.
            the packet contains:
                - SRC IP    <0.0.0.0>
                    ==> explanation: client ip
                - DST IP    <255.255.255.255>
                - DHCP: Request Address <10.1.1.3>
                    ==> ip that offered by DHCP.
            
            ==> V.I Note: DHCP client will choose the best offer according to the lease time
            attribute in the DHCP offer, the lober the better.

            4th: DHCP server that recognizes itself as the winner sends a DHCPACK packet
            in broadcast.
            the packet contains:
                - YIADDR    <10.1.1.3>
                - SRC IP    <DHCP_IP>
                - DST IP    <255.255.255.255>
                - CHADDR    <Client_MAC>

            
            in DHCP spoofing we have send our DHCPOFFER with a greater lease time.
            this will lure the victim to choose our offer and then set
            the configurations we will send.
        - LLMNR and NBT-NS spoofing
            ==> check file: general-LLMNR-NBTNS-spoofing-attack
        - ICMP redirect.
        - Port stealing.
        - mitm in public exchange
            incase of A send messege to B, the following step will followed:
            1st: A will communicate with key dist. server to get B's public key.
            2nd: key dist. server will send B's public key.
            3rd: A will encrypt message with B' public key and send it to B.

            Attack scenario to work, attack should be able to recognize the  queries to the key
            server and take following step:
                1st: A send query B' public key.
                2nd: attacker send query to key dist. server instead of A.
                3rd: key dist. server send B' public key to attacker.
                4th: attacker send his public key instead of B' keys.
        - Intercepting SSL Traffic.
            ==> Quick View: most important thing to remeber here how encryption
            and encrpytion and ssl certificates work. beacuse there is a handshake
            involved in the ssl protocol.
            It ay be possible to incercept, decrypt, read, re-encrypt and resend data.
# -------------------------------   end mitm overview ------------------------------- # 

# ------------------------------- start arp poisoing attack ------------------------------- # 
    # ---------- |Tools| ---------- #
        - dsniff suite.
        - Ettercap.
        - Cain & Abel.
        - Bettercap.
        - arpspoof.
        - wireshark.
        - tcpdump.

    # ---------- |Ettercap| ---------- #
        ==> Quick View: is command line and GUI tool.

    # ---------- |Cain & Abel| ---------- #
        ==> Quick View: using to perform mitm attack, gather information and decrypt.

        1st: configure used interface, from configuration button.
        2nd: enable sniffer. from sniffer icon.
        3rd: go to sniffer tab and start scan mac addresses.
        4th: insert target, open the arp tab
        5th: once we select router from left side, the target will be on the right.
        6th: incase of multiple select, press ctrl.
        7th: click active arp poisoing icon.
    
    # ---------- |arpspoof| ---------- #
        arpspoof -i <interface> -t <target_ip> <spoofed>
        ==> V.I Note: run command in both way to intercept the full duplex.
# -------------------------------   end arp poisoing attack ------------------------------- # 

# ------------------------------- start Intercepting SSL Traffic attack ------------------------------- # 
    # ---------- |Tools| ---------- #
        - sslstrip
        - sslstrips+ | mimtf.py
            - help in bypassing hsts.

    # ---------- |sslstrip| ---------- #
        ==> Quick View: how sslstrip work:
            1st: preform a MITM attack on the HTTPS connection between the victim and server.
            2nd: replace the HTTPS links with HTTP clone links and remembers the links which were changed.
            3rd: communicates with the victim over HTTP connection for any secure link.
            4th: communicates with the legitimate server over HTTPS for the same seurce link.
            5th: the sslstrp attacker machine transparently proxies the communicaations between the victim and the server.
            6th: favicon images are replaced with the known "Secure Icon" to provide familiar visual confirmation.
            7th: sslstrip logs all traffic passing through so passwords, credentials etc/ are stolen without the victim knowing.

            1st: echo 1 > /proc/sys/net/ipv4>ip_forward
            2nd: iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-ports 8080
            3rd: ssltrip -a -f -l <local_port> -w <output_file>
            4th: running arp poisoing.
                bettercap -G <web_server_ip> -T <target_ip> --proxy-https

    # ---------- |sslstrips+ | mimtf.py | ---------- #
        ==> V.I Note; we need to run a DNS server, to be able to intercept and edit the victim DNS request.
        the following attack in action:
        1st: the victim goes to google.com (not in the HSTS preload list of browser)
        2nd: attacker intercept the traffic and change accounts.google.com to acccounts.google.com
        3rd: the victim makes a dns request for the domain accounts.google.com
        4th: we intercept the request, forward the real dns request and respond the victim with fake domain and
        IP address.
        5th: broswer will search of the domain is in accessed securely HTTPS.

        python mimtf.py -i <interface> --spoof --arp --dns --hsts --getaway <web_server_ip> --targets <target_ip>
# -------------------------------   end Intercepting SSL Traffic attack ------------------------------- # 